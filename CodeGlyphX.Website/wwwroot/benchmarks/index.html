<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Benchmarks - CodeGlyphX</title>
  <meta name="description" content="Performance benchmarks comparing CodeGlyphX with other .NET barcode libraries. Transparent methodology and raw data." />
  
  <link rel="canonical" href="https://codeglyphx.com/benchmarks/" />
  <link rel="icon" type="image/png" href="/codeglyphx-qr-icon.png" />
  <link rel="apple-touch-icon" href="/codeglyphx-qr-icon.png" />
  <link rel="preconnect" href="https://img.shields.io" crossorigin />
  <link rel="dns-prefetch" href="https://img.shields.io" />
  <script>(function(){const t=localStorage.getItem('theme')||'auto';document.documentElement.dataset.theme=t;})();</script>
  <style>:root{--bg-dark:#0a0e14;--bg-card:#151b23;--text:#e6edf3;--text-muted:#8b949e;--primary:#2f81f7;--primary-light:#58a6ff}[data-theme="light"]{--bg-dark:#ffffff;--bg-card:#f6f8fa;--text:#1f2328;--text-muted:#656d76;--primary:#0969da;--primary-light:#0550ae}*,*::before,*::after{box-sizing:border-box}html,body{margin:0;padding:0;min-height:100vh}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,sans-serif;background:var(--bg-dark);color:var(--text);line-height:1.6}svg{max-width:100%;height:auto}.header svg,.nav svg,.nav-icon svg,.nav-cta svg,.btn-icon{width:20px;height:20px;flex-shrink:0}.feature-icon{width:48px;height:48px;display:flex;align-items:center;justify-content:center}.feature-icon svg{width:24px;height:24px}.hero-code-preview{display:flex;justify-content:center;gap:1.5rem}.code-preview-item{width:80px;height:80px;padding:12px;display:flex;align-items:center;justify-content:center;background:#fff;border-radius:12px}.code-preview-item svg{width:100%;height:100%}.barcode-preview{width:120px;height:60px}.header{position:sticky;top:0;z-index:100;background:var(--bg-dark);border-bottom:1px solid rgba(255,255,255,0.1)}.header-content{display:flex;align-items:center;justify-content:space-between;max-width:1400px;margin:0 auto;padding:0.75rem 1.5rem}.brand{display:flex;align-items:center;gap:0.5rem;text-decoration:none;color:var(--text);font-weight:600}.brand-icon img{width:28px;height:28px}.nav{display:flex;align-items:center;gap:1rem}.nav-links{display:flex;gap:0.25rem}.nav-links a{padding:0.5rem 1rem;color:var(--text-muted);text-decoration:none}.nav-actions{display:flex;align-items:center;gap:0.5rem}.theme-toggle{display:flex;align-items:center;gap:0.25rem;padding:0.25rem;background:var(--bg-card);border-radius:8px}.theme-toggle button{display:flex;align-items:center;justify-content:center;width:32px;height:32px;padding:0;background:transparent;border:none;border-radius:6px;color:var(--text-muted);cursor:pointer}.theme-toggle button.active{background:var(--primary);color:white}.theme-toggle button svg{width:18px;height:18px}.hero{min-height:60vh}.nav-cta{display:flex;align-items:center;gap:0.5rem;padding:0.5rem 1rem;background:var(--primary);color:#fff;border-radius:8px;text-decoration:none;font-weight:600}.nav-icon{display:flex;padding:0.5rem;color:var(--text-muted)}.copy-btn{opacity:0}</style>
  <link rel="stylesheet" href="/css/app.css" media="print" onload="this.media='all'" />
  <noscript><link rel="stylesheet" href="/css/app.css" /></noscript>
  
  
  <!-- Open Graph -->
  <meta property="og:title" content="Benchmarks - CodeGlyphX" />
  <meta property="og:description" content="Performance benchmarks comparing CodeGlyphX with other .NET barcode libraries." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://codeglyphx.com/benchmarks/" />
  <meta property="og:image" content="https://codeglyphx.com/codeglyphx-qr-icon.png" />
  <meta property="og:site_name" content="CodeGlyphX" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Benchmarks - CodeGlyphX" />
  <meta name="twitter:description" content="Performance benchmarks comparing CodeGlyphX with other .NET barcode libraries." />
  <meta name="twitter:image" content="https://codeglyphx.com/codeglyphx-qr-icon.png" />
  
  <script type="application/ld+json">
  {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
          { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://codeglyphx.com/" },
          { "@type": "ListItem", "position": 2, "name": "Benchmarks", "item": "https://codeglyphx.com/benchmarks/" }
      ]
  }
  </script>
</head>
<body>
  <div class="page">
<header class="header">
    <div class="header-content">
        <a href="/" class="brand">
            <div class="brand-icon">
                <img src="/codeglyphx-qr-icon.png" alt="CodeGlyphX logo" width="28" height="28" />
            </div>
            <span>CodeGlyphX</span>
        </a>

        <!-- Mobile hamburger toggle -->
        <input type="checkbox" id="nav-toggle" class="nav-toggle-checkbox" />
        <label for="nav-toggle" class="nav-toggle" aria-label="Toggle navigation">
            <span></span>
            <span></span>
            <span></span>
        </label>

        <nav class="nav" aria-label="Main navigation">
            <div class="nav-links">
                <a href="/">Home</a>
                <a href="/playground/">Playground</a>
                <a href="/docs/">Docs</a>
                <a href="/faq/">FAQ</a>
                <a href="/benchmarks/">Benchmarks</a>
                <a href="/showcase/">Showcase</a>
            </div>
            <div class="nav-actions">
                <div class="theme-toggle" role="group" aria-label="Theme selection">
                    <button data-theme="auto" title="Auto (system)" aria-label="Auto theme">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="3" width="20" height="14" rx="2"/>
                            <path d="M8 21h8M12 17v4"/>
                        </svg>
                    </button>
                    <button data-theme="light" title="Light" aria-label="Light theme">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="5"/>
                            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                        </svg>
                    </button>
                    <button data-theme="dark" title="Dark" aria-label="Dark theme">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
                        </svg>
                    </button>
                </div>
                <a href="https://github.com/EvotecIT/CodeGlyphX" target="_blank" rel="noopener" class="nav-icon" title="GitHub" aria-label="GitHub">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                </a>
                <a href="https://www.nuget.org/packages/CodeGlyphX" target="_blank" rel="noopener" class="nav-cta">
                    <svg viewBox="0 0 24 24" fill="currentColor" class="nav-cta-icon">
                        <path d="M12 0L1.75 6v12L12 24l10.25-6V6zm-1.775 18a3.11 3.11 0 01-3.111-3.111 3.11 3.11 0 013.111-3.111 3.11 3.11 0 013.111 3.111A3.11 3.11 0 0110.225 18zm4.91-6.944a1.867 1.867 0 01-1.867-1.867 1.867 1.867 0 011.866-1.866 1.867 1.867 0 011.867 1.866 1.867 1.867 0 01-1.867 1.867z"/>
                    </svg>
                    Get Started
                </a>
            </div>
        </nav>
    </div>
</header>

<main>
<div class="benchmark-page">
    <section class="benchmark-hero">
        <h1>Performance Benchmarks</h1>
        <p class="benchmark-intro">
            Benchmarks measure specific scenarios under controlled, ideal lab conditions.
            Real-world performance varies based on input size, hardware, runtime, and many other factors.
            Treat these numbers as directional, not definitive.
        </p>
        <div class="benchmark-meta" data-benchmark-meta></div>
    </section>

    <section class="benchmark-section">
        <h2>About These Benchmarks</h2>

        <div class="benchmark-info-grid">
            <div class="benchmark-info-card">
                <h3>Quick vs Full</h3>
                <p>
                    <strong>Quick mode</strong> uses minimal iterations (warmup=1, iterations=3) for fast feedback during development.
                    Results have higher variance and should be treated as rough estimates.
                </p>
                <p>
                    <strong>Full mode</strong> uses BenchmarkDotNet defaults with statistical analysis, multiple iterations,
                    and outlier detection. These results are more reliable for comparisons.
                </p>
            </div>

            <div class="benchmark-info-card">
                <h3>What We Measure</h3>
                <ul>
                    <li><strong>Mean</strong> - Average time per operation (lower is better)</li>
                    <li><strong>Allocated</strong> - Managed memory per operation (lower is better)</li>
                </ul>
                <p>
                    Comparisons target PNG output and include both encoding and rendering time,
                    not just the encoding step.
                </p>
            </div>

            <div class="benchmark-info-card">
                <h3>Compared Libraries</h3>
                <ul>
                    <li><strong>ZXing.Net</strong> - with ImageSharp 3.x renderer</li>
                    <li><strong>QRCoder</strong> - PngByteQRCode (managed PNG)</li>
                    <li><strong>Barcoder</strong> - with ImageSharp renderer</li>
                </ul>
                <p>
                    Each library has different strengths. Configuration attempts to match
                    CodeGlyphX defaults where possible.
                </p>
            </div>

            <div class="benchmark-info-card">
                <h3>Limitations</h3>
                <ul>
                    <li>Benchmarks run on a single machine configuration</li>
                    <li>Numbers reflect ideal conditions, not production guarantees</li>
                    <li>Results may differ on other hardware/OS</li>
                    <li>Specific scenarios may not reflect your use case</li>
                    <li>Library versions and configurations affect results</li>
                </ul>
            </div>
        </div>
    </section>

    <section class="benchmark-section">
        <h2>Run Mode</h2>
        <div class="benchmark-mode-selector">
            <button class="benchmark-mode-btn active" data-mode="quick">Quick</button>
            <button class="benchmark-mode-btn" data-mode="full">Full</button>
        </div>
        <p class="benchmark-mode-note" data-mode-note></p>
    </section>

    <section class="benchmark-section">
        <h2>Comparison Summary</h2>
        <p class="section-description">
            How CodeGlyphX compares to the fastest library in each scenario.
            "vs Fastest" shows lag when CodeGlyphX is not fastest; when CodeGlyphX is fastest it also includes the lead vs the runner-up.
            Use the vendor columns and Δ lines for full context.
            See "Detailed Results" below for full vendor breakdowns.
        </p>
        <div class="benchmark-table-container" data-benchmark-summary>
            <p class="loading-text">Loading benchmark data...</p>
        </div>
    </section>

    <section class="benchmark-section">
        <h2>Performance Comparison</h2>
        <p class="section-description">
            Visual comparison of CodeGlyphX vs the fastest competitor in each scenario.
            Shorter bars are better (lower execution time).
        </p>
        <div class="benchmark-charts" data-benchmark-charts>
            <p class="loading-text">Loading chart data...</p>
        </div>
    </section>

    <section class="benchmark-section">
        <h2>Detailed Results</h2>
        <p class="section-description">
            Per-scenario breakdown showing all vendors tested. Not all scenarios have comparison data
            (some libraries don't support certain barcode types).
        </p>
        <div class="benchmark-details" data-benchmark-details>
            <p class="loading-text">Loading detailed results...</p>
        </div>
    </section>

    <section class="benchmark-section">
        <h2>Baseline Performance</h2>
        <p class="section-description">
            CodeGlyphX-only benchmarks without comparisons. Useful for tracking performance across versions.
        </p>
        <div class="benchmark-baseline" data-benchmark-baseline>
            <p class="loading-text">Loading baseline data...</p>
        </div>
    </section>

    <section class="benchmark-section">
        <h2>Environment</h2>
        <div class="benchmark-environment" data-benchmark-environment>
            <p class="loading-text">Loading environment info...</p>
        </div>
    </section>

    <section class="benchmark-section benchmark-notes">
        <h2>Methodology Notes</h2>
        <div data-benchmark-notes>
            <ul>
                <li>Comparisons target PNG output and include encode+render (not encode-only).</li>
                <li>Module size and quiet zone are matched to CodeGlyphX defaults where possible.</li>
                <li>Image dimensions are derived from CodeGlyphX module calculations.</li>
                <li>QR decode comparisons use raw RGBA32 bytes.</li>
                <li>QR decode "clean" uses balanced settings; "noisy" uses robust with aggressive sampling.</li>
            </ul>
        </div>
    </section>

    <section class="benchmark-section">
        <h2>Run Your Own</h2>
        <p>
            Clone the repository and run benchmarks on your own hardware:
        </p>
        <pre class="code-block"><code><span class="comment"># Quick benchmark (fast, less accurate)</span>
pwsh Build/Run-Benchmarks-Compare.ps1

<span class="comment"># Full benchmark (slow, statistically rigorous)</span>
pwsh Build/Run-Benchmarks-Compare.ps1 -Full

<span class="comment"># Generate report</span>
pwsh Build/Generate-BenchmarkReport.ps1 -ArtifactsPath Build/BenchmarkResults/&lt;run-folder&gt;</code></pre>
    </section>
</div>

</main>
<footer class="footer">
    <div class="footer-content">
        <div class="footer-brand">
            <div class="footer-logo">
                <img src="/codeglyphx-qr-icon.png" alt="CodeGlyphX logo" width="28" height="28" />
                <span>CodeGlyphX</span>
            </div>
            <p>Zero-dependency QR &amp; barcode toolkit for .NET</p>
        </div>
        <div class="footer-links">
            <div class="footer-section">
                <h3>Product</h3>
                <a href="/">Home</a>
                <a href="/playground/">Playground</a>
                <a href="/docs/">Docs</a>
                <a href="/benchmarks/">Benchmarks</a>
                <a href="/showcase/">Showcase</a>
            </div>
            <div class="footer-section">
                <h3>Resources</h3>
                <a href="/faq/">FAQ</a>
                <a href="https://www.nuget.org/packages/CodeGlyphX" target="_blank" rel="noopener" aria-label="NuGet Package (opens in new tab)">NuGet Package</a>
                <a href="https://github.com/EvotecIT/CodeGlyphX" target="_blank" rel="noopener" aria-label="GitHub Repository (opens in new tab)">GitHub Repository</a>
                <a href="https://github.com/EvotecIT/CodeGlyphX/issues" target="_blank" rel="noopener" aria-label="Report Issue (opens in new tab)">Report Issue</a>
            </div>
            <div class="footer-section">
                <h3>Company</h3>
                <a href="https://evotec.xyz" target="_blank" rel="noopener" aria-label="Evotec Services (opens in new tab)">Evotec Services</a>
                <a href="https://evotec.xyz/hub" target="_blank" rel="noopener" aria-label="Blog (opens in new tab)">Blog</a>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="footer-badges">
                <a href="https://github.com/EvotecIT/CodeGlyphX" target="_blank" rel="noopener">
                    <img src="https://img.shields.io/github/stars/EvotecIT/CodeGlyphX?style=social" alt="GitHub stars" width="100" height="20" loading="lazy" />
                </a>
                <a href="https://www.nuget.org/packages/CodeGlyphX" target="_blank" rel="noopener">
                    <img src="https://img.shields.io/nuget/dt/CodeGlyphX" alt="NuGet downloads" width="100" height="20" loading="lazy" />
                </a>
            </div>
            <p>Apache 2.0 License &bull; &copy; 2026 Evotec Services sp. z o.o.</p>
        </div>
    </div>
</footer>
<script src="/js/site.js"></script>
  </div>
  <script src="/js/site.js" defer></script>
    <script>
// Theme toggle (Auto/Light/Dark)
(function() {
  function updateActiveTheme(theme) {
    document.querySelectorAll('.theme-toggle button').forEach(function(btn) {
      btn.classList.toggle('active', btn.dataset.theme === theme);
    });
  }

  // Set initial active state
  var currentTheme = document.documentElement.dataset.theme || 'auto';
  updateActiveTheme(currentTheme);

  // Handle theme button clicks
  document.querySelectorAll('.theme-toggle button[data-theme]').forEach(function(btn) {
    btn.addEventListener('click', function() {
      var theme = this.dataset.theme;
      document.documentElement.dataset.theme = theme;
      localStorage.setItem('theme', theme);
      updateActiveTheme(theme);
    });
  });
})();

// Keyboard focus visibility (show focus ring only for keyboard navigation)
function enableKeyboardFocus() { document.body.classList.add('using-keyboard'); }
function disableKeyboardFocus() { document.body.classList.remove('using-keyboard'); }
globalThis.addEventListener('keydown', function(e) {
  if (e.key === 'Tab' || e.key === 'ArrowUp' || e.key === 'ArrowDown' || e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
    enableKeyboardFocus();
  }
});
globalThis.addEventListener('mousedown', disableKeyboardFocus, true);
globalThis.addEventListener('touchstart', disableKeyboardFocus, true);

// Mobile nav toggle
const navToggle = document.getElementById('nav-toggle');
if (navToggle) {
  navToggle.addEventListener('change', function() {
    document.body.classList.toggle('nav-open', this.checked);
  });
}

// Benchmark summary renderer
(function() {
  let benchSummaryPromise = null;
  function loadBenchmarkSummary() {
    if (!benchSummaryPromise) {
      benchSummaryPromise = fetch('/data/benchmark-summary.json', { cache: 'no-store' })
        .then(function(res) { return res.ok ? res.json() : null; })
        .catch(function() { return null; });
    }
    return benchSummaryPromise;
  }

  function pickBenchmarkSummary(data) {
    if (!data) return null;
    var order = [
      ['windows', 'quick'],
      ['windows', 'full'],
      ['linux', 'quick'],
      ['linux', 'full'],
      ['macos', 'quick'],
      ['macos', 'full']
    ];
    for (var i = 0; i < order.length; i++) {
      var os = order[i][0];
      var mode = order[i][1];
      var entry = data && data[os] && data[os][mode];
      if (entry && entry.summary && entry.summary.length) return entry;
    }
    var keys = Object.keys(data || {});
    for (var k = 0; k < keys.length; k++) {
      var osEntry = data[keys[k]] || {};
      var modes = Object.keys(osEntry || {});
      for (var m = 0; m < modes.length; m++) {
        var modeEntry = osEntry[modes[m]];
        if (modeEntry && modeEntry.summary && modeEntry.summary.length) return modeEntry;
      }
    }
    return null;
  }

  function appendVendorCell(td, vendor, delta) {
    if (!vendor) return;
    if (vendor.mean) {
      var mean = document.createElement('div');
      mean.textContent = vendor.mean;
      td.appendChild(mean);
    }
    if (vendor.allocated) {
      var alloc = document.createElement('div');
      alloc.className = 'bench-dim';
      alloc.textContent = vendor.allocated;
      td.appendChild(alloc);
    }
    if (delta) {
      var d = document.createElement('div');
      d.className = 'bench-delta';
      d.textContent = delta;
      td.appendChild(d);
    }
  }

  function renderBenchmarkSummary() {
    var container = document.querySelector('[data-benchmark-summary]');
    if (!container || container.dataset.loaded === 'true') return;

    loadBenchmarkSummary().then(function(data) {
      var entry = pickBenchmarkSummary(data);
      if (!entry || !entry.summary || !entry.summary.length) {
        container.textContent = 'Benchmark summary unavailable.';
        container.dataset.loaded = 'true';
        return;
      }

      var table = document.createElement('table');
      table.className = 'bench-table bench-summary-table';

      var thead = document.createElement('thead');
      thead.innerHTML = '<tr>' +
        '<th>Benchmark</th>' +
        '<th>Scenario</th>' +
        '<th>Fastest</th>' +
        '<th>CodeGlyphX</th>' +
        '<th>ZXing.Net</th>' +
        '<th>QRCoder</th>' +
        '<th>Barcoder</th>' +
        '<th>CodeGlyphX vs Fastest</th>' +
        '<th>Alloc vs Fastest</th>' +
        '<th>Rating</th>' +
        '</tr>';
      table.appendChild(thead);

      var tbody = document.createElement('tbody');
      entry.summary.forEach(function(item) {
        var row = document.createElement('tr');
        var vendors = item.vendors || {};
        var deltas = item.deltas || {};

        var cells = [
          item.benchmark || '',
          item.scenario || '',
          item.fastestVendor ? (item.fastestVendor + ' ' + (item.fastestMean || '')).trim() : (item.fastestMean || '')
        ];

        cells.forEach(function(text) {
          var td = document.createElement('td');
          td.textContent = text;
          row.appendChild(td);
        });

        var cgxTd = document.createElement('td');
        appendVendorCell(cgxTd, vendors['CodeGlyphX'], '');
        row.appendChild(cgxTd);

        var zxTd = document.createElement('td');
        appendVendorCell(zxTd, vendors['ZXing.Net'], deltas['ZXing.Net']);
        row.appendChild(zxTd);

        var qrcTd = document.createElement('td');
        appendVendorCell(qrcTd, vendors['QRCoder'], deltas['QRCoder']);
        row.appendChild(qrcTd);

        var barTd = document.createElement('td');
        appendVendorCell(barTd, vendors['Barcoder'], deltas['Barcoder']);
        row.appendChild(barTd);

        var ratioTd = document.createElement('td');
        ratioTd.textContent = item.codeGlyphXVsFastestText || '';
        row.appendChild(ratioTd);

        var allocTd = document.createElement('td');
        allocTd.textContent = item.codeGlyphXAllocVsFastestText || '';
        row.appendChild(allocTd);

        var ratingTd = document.createElement('td');
        ratingTd.textContent = item.rating || '';
        row.appendChild(ratingTd);

        tbody.appendChild(row);
      });
      table.appendChild(tbody);

      container.innerHTML = '';
      container.appendChild(table);
      container.dataset.loaded = 'true';
    });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', renderBenchmarkSummary);
  } else {
    renderBenchmarkSummary();
  }
})();

  </script>
  <script>
// Benchmark page renderer
(function() {
  let currentMode = 'quick';
  let currentOs = 'windows';
  let summaryData = null;
  let detailData = null;

  function loadJson(url) {
    return fetch(url, { cache: 'no-store' })
      .then(function(res) { return res.ok ? res.json() : null; })
      .catch(function() { return null; });
  }

  function escapeHtml(text) {
    if (!text) return '';
    return String(text).replace(/[&<>"']/g, function(m) {
      return { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[m];
    });
  }

  function getRatingIcon(rating) {
    switch (rating) {
      case 'good':
        return '<span class="rating-icon rating-good" aria-label="Good">●</span>';
      case 'ok':
        return '<span class="rating-icon rating-ok" aria-label="Okay">●</span>';
      case 'bad':
        return '<span class="rating-icon rating-bad" aria-label="Needs improvement">●</span>';
      default:
        return '<span class="rating-icon">-</span>';
    }
  }

  function getEntry(data, os, mode) {
    return data?.[os]?.[mode] ?? null;
  }

  function findBestEntry(data) {
    // Priority: windows full > windows quick > linux full > linux quick > macos
    const order = [
      ['windows', 'full'], ['windows', 'quick'],
      ['linux', 'full'], ['linux', 'quick'],
      ['macos', 'full'], ['macos', 'quick']
    ];
    for (let i = 0; i < order.length; i++) {
      const entry = getEntry(data, order[i][0], order[i][1]);
      if (entry && (entry.summary?.length || entry.comparisons?.length)) {
        currentOs = order[i][0];
        currentMode = order[i][1];
        return entry;
      }
    }
    return null;
  }

  function formatDate(isoString) {
    if (!isoString) return 'Unknown';
    try {
      const d = new Date(isoString);
      return d.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
    } catch {
      return isoString;
    }
  }

  function formatMode(mode) {
    if (!mode) return 'Unknown';
    return mode.charAt(0).toUpperCase() + mode.slice(1);
  }

  function renderMeta(entry) {
    const container = document.querySelector('[data-benchmark-meta]');
    if (!container) return;

    if (!entry) {
      container.innerHTML = '<p class="benchmark-warning">No benchmark data available.</p>';
      return;
    }

    const meta = entry.meta || {};
    let html = '<div class="benchmark-meta-grid">';
    html += '<div class="meta-item"><span class="meta-label">Last Updated</span><span class="meta-value">' + escapeHtml(formatDate(entry.generatedUtc)) + '</span></div>';
    html += '<div class="meta-item"><span class="meta-label">Mode</span><span class="meta-value">' + escapeHtml(formatMode(entry.runMode)) + '</span></div>';
    html += '<div class="meta-item"><span class="meta-label">OS</span><span class="meta-value">' + escapeHtml(entry.os || 'unknown') + '</span></div>';
    html += '<div class="meta-item"><span class="meta-label">Framework</span><span class="meta-value">' + escapeHtml(entry.framework || 'unknown') + '</span></div>';
    html += '</div>';
    container.innerHTML = html;
  }

  function renderModeSelector(summaryData, detailData) {
    const buttons = document.querySelectorAll('.benchmark-mode-btn');
    const noteEl = document.querySelector('[data-mode-note]');

    buttons.forEach(function(btn) {
      const mode = btn.dataset.mode;
      const summaryEntry = getEntry(summaryData, currentOs, mode);
      const detailEntry = getEntry(detailData, currentOs, mode);
      const hasData = summaryEntry?.summary?.length || detailEntry?.comparisons?.length;

      btn.disabled = !hasData;
      btn.classList.toggle('active', mode === currentMode);

      if (!hasData) {
        btn.title = 'No ' + mode + ' benchmark data available yet';
      } else {
        btn.title = '';
      }

      btn.onclick = function() {
        if (this.disabled) return;
        currentMode = mode;
        buttons.forEach(function(b) { b.classList.toggle('active', b.dataset.mode === mode); });
        renderAll();
      };
    });

    // Update note
    if (noteEl) {
      const entry = getEntry(summaryData, currentOs, currentMode);
      if (entry && entry.runModeDetails) {
        noteEl.textContent = entry.runModeDetails;
      } else if (currentMode === 'quick') {
        noteEl.textContent = 'Quick mode: Fewer iterations, higher variance. Use for rough estimates only.';
      } else {
        noteEl.textContent = 'Full mode: BenchmarkDotNet defaults with statistical analysis.';
      }
    }
  }

  function renderVendorCell(vendor, delta, extraClass) {
    if (!vendor || (!vendor.mean && !vendor.allocated)) {
      return '<td class="bench-na">-</td>';
    }
    const cls = extraClass ? ' class="' + extraClass + '"' : '';
    let html = '<td' + cls + '>';
    if (vendor.mean) {
      html += '<div>' + escapeHtml(vendor.mean) + '</div>';
    }
    if (vendor.allocated) {
      html += '<div class="bench-dim">' + escapeHtml(vendor.allocated) + '</div>';
    }
    if (delta) {
      html += '<div class="bench-dim bench-delta">' + escapeHtml(delta) + '</div>';
    }
    html += '</td>';
    return html;
  }

  function renderSummaryTable(entry) {
    const container = document.querySelector('[data-benchmark-summary]');
    if (!container) return;

    if (!entry || !entry.summary || !entry.summary.length) {
      container.innerHTML = '<p class="benchmark-no-data">No comparison summary available for this mode.</p>';
      return;
    }

    const vendorSet = {};
    entry.summary.forEach(function(item) {
      if (item.vendors) {
        Object.keys(item.vendors).forEach(function(v) {
          if (v !== 'CodeGlyphX') vendorSet[v] = true;
        });
      }
    });
    const preferred = ['ZXing.Net', 'QRCoder', 'Barcoder'];
    const vendorList = preferred.filter(function(v) { return vendorSet[v]; });
    Object.keys(vendorSet).forEach(function(v) {
      if (preferred.indexOf(v) === -1) vendorList.push(v);
    });

    let html = '<div class="table-scroll"><table class="bench-table bench-summary-table">';
    html += '<thead><tr>';
    html += '<th>Benchmark</th>';
    html += '<th>Scenario</th>';
    html += '<th>Fastest</th>';
    html += '<th>CodeGlyphX</th>';
    vendorList.forEach(function(v) {
      html += '<th>' + escapeHtml(v) + '</th>';
    });
    html += '<th>CodeGlyphX vs Fastest</th>';
    html += '<th>Alloc vs Fastest</th>';
    html += '<th>Rating</th>';
    html += '</tr></thead><tbody>';

    entry.summary.forEach(function(item) {
      html += '<tr>';
      html += '<td>' + escapeHtml(item.benchmark || '') + '</td>';
      html += '<td>' + escapeHtml(item.scenario || '') + '</td>';

      html += '<td class="bench-fastest">';
      html += '<div>' + escapeHtml(item.fastestVendor || '') + '</div>';
      if (item.fastestMean) html += '<div class="bench-dim">' + escapeHtml(item.fastestMean) + '</div>';
      html += '</td>';

      const cgx = item.vendors?.['CodeGlyphX'] || {};
      const isCgxFastest = item.fastestVendor === 'CodeGlyphX';
      html += renderVendorCell(cgx, '', isCgxFastest ? 'bench-winner' : '');

      vendorList.forEach(function(v) {
        const vendor = item.vendors?.[v];
        const delta = item.deltas?.[v] || '';
        html += renderVendorCell(vendor, delta, '');
      });

      html += '<td>' + escapeHtml(item.codeGlyphXVsFastestText || (item.codeGlyphXVsFastest ? item.codeGlyphXVsFastest + ' x' : '-')) + '</td>';
      html += '<td>' + escapeHtml(item.codeGlyphXAllocVsFastestText || (item.codeGlyphXAllocVsFastest ? item.codeGlyphXAllocVsFastest + ' x' : '-')) + '</td>';

      const ratingClass = 'bench-rating-' + (item.rating || 'unknown');
      const ratingIcon = getRatingIcon(item.rating);
      html += '<td class="' + ratingClass + '" title="' + escapeHtml(item.rating || '') + '">' + ratingIcon + '</td>';
      html += '</tr>';
    });

    html += '</tbody></table></div>';

    // Add legend
    html += '<div class="bench-legend">';
    html += '<span class="bench-legend-item">' + getRatingIcon('good') + ' within 10% time, 25% allocation</span>';
    html += '<span class="bench-legend-item">' + getRatingIcon('ok') + ' within 50% time, 100% allocation</span>';
    html += '<span class="bench-legend-item">' + getRatingIcon('bad') + ' outside these bounds</span>';
    html += '</div>';

    container.innerHTML = html;
  }

  function renderDetails(entry) {
    const container = document.querySelector('[data-benchmark-details]');
    if (!container) return;

    if (!entry || !entry.comparisons || !entry.comparisons.length) {
      container.innerHTML = '<p class="benchmark-no-data">No detailed comparison data available for this mode.</p>';
      return;
    }

    let html = '';
    entry.comparisons.forEach(function(comp) {
      html += '<div class="benchmark-detail-section">';
      html += '<h3>' + escapeHtml(comp.title) + '</h3>';

      if (!comp.scenarios || !comp.scenarios.length) {
        html += '<p class="bench-na">No scenarios</p>';
        html += '</div>';
        return;
      }

      html += '<div class="table-scroll"><table class="bench-table bench-detail-table">';
      html += '<thead><tr><th>Scenario</th>';

      // Collect all vendors from all scenarios
      const allVendors = {};
      comp.scenarios.forEach(function(s) {
        if (s.vendors) {
          Object.keys(s.vendors).forEach(function(v) { allVendors[v] = true; });
        }
      });
      const vendorList = Object.keys(allVendors).sort(function(a, b) {
        if (a === 'CodeGlyphX') return -1;
        if (b === 'CodeGlyphX') return 1;
        return a.localeCompare(b);
      });

      vendorList.forEach(function(v) {
        html += '<th>' + escapeHtml(v) + '</th>';
      });
      html += '</tr></thead><tbody>';

      comp.scenarios.forEach(function(scenario) {
        html += '<tr>';
        html += '<td>' + escapeHtml(scenario.name) + '</td>';

        vendorList.forEach(function(v) {
          const vendor = scenario.vendors?.[v];
          if (vendor && (vendor.mean || vendor.allocated)) {
            html += '<td>';
            if (vendor.mean) {
              html += '<div>' + escapeHtml(vendor.mean) + '</div>';
            }
            if (vendor.allocated) {
              html += '<div class="bench-dim">' + escapeHtml(vendor.allocated) + '</div>';
            }
            const delta = scenario.deltas?.[v];
            if (delta) {
              html += '<div class="bench-dim bench-delta">' + escapeHtml(delta) + '</div>';
            }
            html += '</td>';
          } else {
            html += '<td class="bench-na">-</td>';
          }
        });
        html += '</tr>';
      });

      html += '</tbody></table></div>';
      html += '</div>';
    });

    container.innerHTML = html;
  }

  function renderBaseline(entry) {
    const container = document.querySelector('[data-benchmark-baseline]');
    if (!container) return;

    if (!entry || !entry.baselines || !entry.baselines.length) {
      container.innerHTML = '<p class="benchmark-no-data">No baseline data available for this mode.</p>';
      return;
    }

    let html = '';
    entry.baselines.forEach(function(baseline) {
      html += '<div class="benchmark-detail-section">';
      html += '<h3>' + escapeHtml(baseline.title) + '</h3>';

      if (!baseline.rows || !baseline.rows.length) {
        html += '<p class="bench-na">No data</p>';
        html += '</div>';
        return;
      }

      html += '<div class="table-scroll"><table class="bench-table bench-baseline-table">';
      html += '<thead><tr><th>Scenario</th><th>Mean</th><th>Allocated</th></tr></thead>';
      html += '<tbody>';

      baseline.rows.forEach(function(row) {
        html += '<tr>';
        html += '<td>' + escapeHtml(row.scenario) + '</td>';
        html += '<td>' + escapeHtml(row.mean || '-') + '</td>';
        html += '<td>' + escapeHtml(row.allocated || '-') + '</td>';
        html += '</tr>';
      });

      html += '</tbody></table></div>';
      html += '</div>';
    });

    container.innerHTML = html;
  }

  function renderEnvironment(entry) {
    const container = document.querySelector('[data-benchmark-environment]');
    if (!container) return;

    if (!entry || !entry.meta) {
      container.innerHTML = '<p class="benchmark-no-data">No environment info available.</p>';
      return;
    }

    const meta = entry.meta;
    let html = '<div class="benchmark-env-grid">';

    const items = [
      ['OS', meta.osDescription],
      ['Architecture', meta.osArchitecture || meta.processArchitecture],
      ['.NET SDK', meta.dotnetSdk],
      ['Runtime', meta.runtime],
      ['Processors', meta.processorCount]
    ];

    items.forEach(function(item) {
      if (item[1]) {
        html += '<div class="env-item"><span class="env-label">' + escapeHtml(item[0]) + '</span>';
        html += '<span class="env-value">' + escapeHtml(item[1]) + '</span></div>';
      }
    });

    html += '</div>';
    container.innerHTML = html;
  }

  function renderNotes(entry) {
    const container = document.querySelector('[data-benchmark-notes]');
    if (!container || !entry || !entry.notes || !entry.notes.length) return;

    let html = '<ul>';
    entry.notes.forEach(function(note) {
      if (!note || !note.trim()) return;
      html += '<li>' + escapeHtml(note) + '</li>';
    });
    html += '</ul>';
    container.innerHTML = html;
  }

  function parseTimeValue(str) {
    if (!str) return null;
    // Parse values like "1.234 ms", "567.8 μs", "12.3 ns"
    const match = str.match(/^([\d.]+)\s*(ms|μs|us|ns)/i);
    if (!match) return null;
    const value = parseFloat(match[1]);
    const unit = match[2].toLowerCase();
    // Convert to microseconds for comparison
    if (unit === 'ms') return value * 1000;
    if (unit === 'μs' || unit === 'us') return value;
    if (unit === 'ns') return value / 1000;
    return value;
  }

  function renderCharts(entry) {
    const container = document.querySelector('[data-benchmark-charts]');
    if (!container) return;

    if (!entry || !entry.summary || !entry.summary.length) {
      container.innerHTML = '<p class="benchmark-no-data">No chart data available for this mode.</p>';
      return;
    }

    // Collect chart data from summary
    const chartData = [];
    entry.summary.forEach(function(item) {
      const scenario = item.scenario || item.benchmark || '';
      const cgxMean = item.vendors?.['CodeGlyphX']?.mean || item.codeGlyphXMean;
      const fastestMean = item.fastestMean;
      const fastestVendor = item.fastestVendor;

      if (cgxMean && fastestMean) {
        const cgxValue = parseTimeValue(cgxMean);
        const fastestValue = parseTimeValue(fastestMean);
        if (cgxValue && fastestValue) {
          chartData.push({
            scenario: scenario,
            cgxValue: cgxValue,
            cgxLabel: cgxMean,
            fastestValue: fastestValue,
            fastestLabel: fastestMean,
            fastestVendor: fastestVendor,
            isCgxFastest: fastestVendor === 'CodeGlyphX',
            rating: item.rating
          });
        }
      }
    });

    if (!chartData.length) {
      container.innerHTML = '<p class="benchmark-no-data">No chart data available for this mode.</p>';
      return;
    }

    // Find max value for scaling
    let maxValue = 0;
    chartData.forEach(function(d) {
      maxValue = Math.max(maxValue, d.cgxValue, d.fastestValue);
    });

    let html = '<div class="benchmark-charts-container">';

    chartData.forEach(function(d) {
      const cgxPct = (d.cgxValue / maxValue) * 100;
      const fastestPct = (d.fastestValue / maxValue) * 100;

      html += '<div class="chart-row">';
      html += '<div class="chart-scenario">' + escapeHtml(d.scenario) + '</div>';
      html += '<div class="chart-bars">';

      // CodeGlyphX bar
      html += '<div class="chart-bar-row">';
      html += '<span class="chart-bar-label">CodeGlyphX</span>';
      html += '<div class="chart-bar-container">';
      html += '<div class="chart-bar chart-bar-cgx' + (d.isCgxFastest ? ' chart-bar-winner' : '') + '" style="width: ' + cgxPct + '%"></div>';
      html += '<span class="chart-bar-value">' + escapeHtml(d.cgxLabel) + '</span>';
      html += '</div></div>';

      // Fastest competitor bar (only if different from CodeGlyphX)
      if (!d.isCgxFastest) {
        html += '<div class="chart-bar-row">';
        html += '<span class="chart-bar-label">' + escapeHtml(d.fastestVendor) + '</span>';
        html += '<div class="chart-bar-container">';
        html += '<div class="chart-bar chart-bar-fastest" style="width: ' + fastestPct + '%"></div>';
        html += '<span class="chart-bar-value">' + escapeHtml(d.fastestLabel) + '</span>';
        html += '</div></div>';
      }

      html += '</div></div>';
    });

    html += '</div>';

    // Add chart legend
    html += '<div class="chart-legend">';
    html += '<span class="chart-legend-item"><span class="chart-legend-color chart-legend-cgx"></span> CodeGlyphX</span>';
    html += '<span class="chart-legend-item"><span class="chart-legend-color chart-legend-fastest"></span> Fastest Competitor</span>';
    html += '<span class="chart-legend-item"><span class="chart-legend-color chart-legend-winner"></span> Winner (fastest overall)</span>';
    html += '</div>';

    container.innerHTML = html;
  }

  function renderAll() {
    const summaryEntry = getEntry(summaryData, currentOs, currentMode);
    const detailEntry = getEntry(detailData, currentOs, currentMode);
    const entry = summaryEntry || detailEntry;

    renderMeta(entry);
    renderModeSelector(summaryData, detailData);
    renderSummaryTable(summaryEntry);
    renderCharts(summaryEntry);
    renderDetails(detailEntry);
    renderBaseline(detailEntry);
    renderEnvironment(entry);
    renderNotes(entry);
  }

  function init() {
    // Check if we're on the benchmark page
    if (!document.querySelector('.benchmark-page')) return;

    Promise.all([
      loadJson('/data/benchmark-summary.json'),
      loadJson('/data/benchmark.json')
    ]).then(function(results) {
      summaryData = results[0];
      detailData = results[1];

      // Find best available entry to set initial mode
      findBestEntry(summaryData) || findBestEntry(detailData);

      renderAll();
    });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();

  </script>
</body>
</html>

